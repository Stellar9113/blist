import{_ as e,i as a}from"./index-WwQmHM_O.js";import{r as t,o,c as s,b as r,e as i,f as d,P as l,B as n,j as c,t as u,m,k as w,q as y,_ as p,$ as h,J as v,i as _}from"./vendor-CRD7CLCO.js";const f={class:"shared-container"},b={class:"file-name"},k=e({__name:"shared",setup(e){const k=t(!1),x=t([]),B=[{colKey:"name",title:"文件名",width:300},{colKey:"size",title:"大小",width:100},{colKey:"createdAt",title:"创建时间",width:180},{colKey:"op",title:"操作",width:120}];return o((()=>{(async()=>{k.value=!0;try{const{data:e}=await a.post("/api/files/shared");x.value=e}catch(e){v.error("加载共享文件失败")}finally{k.value=!1}})()})),(e,t)=>{const o=n,g=l,K=h;return _(),s("div",f,[t[1]||(t[1]=r("h2",null,"共享文件",-1)),i(K,{data:x.value,columns:B,loading:k.value,"row-key":"_id"},{name:d((({row:e})=>[r("div",b,[e.isFolder?(_(),m(w(y),{key:0})):(_(),m(w(p),{key:1})),c(" "+u(e.name),1)])])),size:d((({row:e})=>{return[c(u((a=e.size,a<1024?a+"B":a<1048576?(a/1024).toFixed(2)+"KB":a<1073741824?(a/1048576).toFixed(2)+"MB":(a/1073741824).toFixed(2)+"GB")),1)];var a})),createdAt:d((({row:e})=>{return[c(u((a=e.createdAt,new Date(a).toLocaleString())),1)];var a})),op:d((({row:e})=>[i(g,null,{default:d((()=>[i(o,{variant:"text",onClick:t=>(async e=>{try{const t=await a.get(`/api/files/download/${e._id}`,{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=o,s.setAttribute("download",e.originalName),document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch(t){v.error("下载失败")}})(e)},{default:d((()=>t[0]||(t[0]=[c("下载")]))),_:2,__:[0]},1032,["onClick"])])),_:2},1024)])),_:1},8,["data","loading"])])}}},[["__scopeId","data-v-6b15cca3"]]);export{k as default};
