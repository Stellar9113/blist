const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/home-DiDOFBB6.js","assets/js/vendor-CRD7CLCO.js","assets/css/vendor-CrBK61A1.css","assets/css/home-AwDv4-Wp.css","assets/js/shared-5QEVK11h.js","assets/css/shared-BocikLZz.css","assets/js/recent-C0T1Ytp7.js","assets/css/recent-50hTOJU9.css","assets/js/login-BmL8ZrbD.js","assets/css/login-CbCf8J4C.css","assets/js/register-Bu1AAswD.js","assets/css/register-5Xb2Vt21.css","assets/js/share-BfeguwWV.js","assets/css/share-CTDWVlKr.css","assets/js/detail-84FUWXPA.js","assets/css/detail-x7euoq6y.css","assets/js/config-Buf1MB5e.js","assets/css/config-BOD-iTdC.css"])))=>i.map(i=>d[i]);
import{d as e,a as t,r as n,w as o,o as a,c as s,b as r,e as i,f as l,D as c,M as u,C as d,u as m,g as p,h as f,i as h,B as _,j as g,t as v,k as y,l as E,m as O,n as S,p as P,q as k,s as A,v as I,S as b,x as L,I as j,y as w,z as T,A as R,E as N,F as D,G as V,Z as q}from"./vendor-CRD7CLCO.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const C=e("user",{state:()=>({user:null,token:null,config:null}),persist:{key:"blist",storage:localStorage,serializer:{serialize:e=>JSON.stringify(e),deserialize:e=>JSON.parse(e)}}}),J=e=>{const{method:t,url:n,params:o,data:a}=e;return[t,n,JSON.stringify(o),JSON.stringify(a)].join("&")},x=new Map,z=e=>{const t=J(e);if(x.has(t)){x.get(t)(t),x.delete(t)}},B=t.create({baseURL:"",timeout:1e4});B.interceptors.request.use((e=>{z(e),(e=>{const n=J(e);e.cancelToken=e.cancelToken||new t.CancelToken((e=>{x.has(n)||x.set(n,e)}))})(e);const{token:n}=JSON.parse(localStorage.getItem("blist"))||{};return e.headers.Authorization=n?`Bearer ${n}`:"",e}),(e=>Promise.reject(e))),B.interceptors.response.use((e=>(z(e.config),e)),(e=>{var t,n;const o=JSON.parse(localStorage.getItem("blist"))||{};return(null==(t=null==o?void 0:o.site)?void 0:t.anonymousUpload)||401!==(null==(n=e.response)?void 0:n.status)||(localStorage.removeItem("blist"),location.href="/login"),z(e.config||{}),Promise.reject(e)}));const $=(e,t)=>{const n=e.__vccOpts||e;for(const[o,a]of t)n[o]=a;return n},M={class:"layout-container"},U={class:"header"},F={class:"user-info"},G={class:"main-container"},H={class:"content"},K=$({__name:"App",setup(e){const t=m(),w=p(),T=C(),R=n("home"),N=n(!1),D=[{content:"个人设置",value:"settings"},{content:"退出登录",value:"logout"}],V=({value:e})=>{"logout"===e&&(T.user=null,T.token="",t.push("/login"))},q=e=>{R.value=e},J=e=>{const t=e.split("/").filter(Boolean);R.value=t.length>1?t[1]:t[0]||"home"};o((()=>w.path),(e=>J(e)));return a((async()=>{(async()=>{var e;try{const{data:e}=await B.post("/api/auth/config");T.config=e}catch({response:t}){message.error(null==(e=null==t?void 0:t.data)?void 0:e.error)}})(),J(location.pathname)})),(e,t)=>{const n=_,o=c,a=P,m=b,p=j,w=u,C=f("router-view"),J=d;return h(),s("div",M,[r("div",U,[t[1]||(t[1]=r("div",{class:"logo"},[r("span",{class:"title"},"Blist网盘")],-1)),r("div",F,[i(o,{options:D,onClick:V},{default:l((()=>[i(n,{variant:"text"},{suffix:l((()=>[i(y(E))])),default:l((()=>{var e;return[g(v(null==(e=y(T).user)?void 0:e.username)+" ",1)]})),_:1})])),_:1})])]),r("div",G,[i(w,{theme:"light",collapsed:N.value,value:R.value,defaultValue:"admin",onChange:q,class:"side-menu"},{operations:l((()=>[i(n,{class:"t-demo-collapse-btn",variant:"text",shape:"square",onClick:t[0]||(t[0]=e=>N.value=!N.value)},{icon:l((()=>[i(p,{name:"view-list"})])),_:1})])),default:l((()=>{var e;return[i(a,{value:"home",to:"/home"},{icon:l((()=>[i(y(k))])),default:l((()=>[t[2]||(t[2]=g(" 我的文件 "))])),_:1,__:[2]}),i(a,{value:"shared",to:"/shared"},{icon:l((()=>[i(y(A))])),default:l((()=>[t[3]||(t[3]=g(" 共享文件 "))])),_:1,__:[3]}),i(a,{value:"recent",to:"/recent"},{icon:l((()=>[i(y(I))])),default:l((()=>[t[4]||(t[4]=g(" 最近文件 "))])),_:1,__:[4]}),"admin"===(null==(e=y(T).user)?void 0:e.role)?(h(),O(m,{key:0,value:"admin",title:"后台管理"},{icon:l((()=>[i(y(L))])),default:l((()=>[i(a,{value:"config",to:"/admin/config"},{default:l((()=>t[5]||(t[5]=[r("span",null,"系统配置",-1)]))),_:1,__:[5]})])),_:1})):S("",!0)]})),_:1},8,["collapsed","value"]),r("div",H,[i(J,null,{default:l((()=>[i(C)])),_:1})])])])}}},[["__scopeId","data-v-610b0264"]]),W={},Z=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map((e=>Promise.resolve(e).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=(null==n?void 0:n.nonce)||(null==n?void 0:n.getAttribute("nonce"));o=e(t.map((e=>{if((e=function(e){return"/"+e}(e))in W)return;W[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script"),o.crossOrigin="",o.href=e,a&&o.setAttribute("nonce",a),document.head.appendChild(o),t?new Promise(((t,n)=>{o.addEventListener("load",t),o.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))},Q=[{path:"/home",name:"Home",component:()=>Z((()=>import("./home-DiDOFBB6.js")),__vite__mapDeps([0,1,2,3]))},{path:"/shared",name:"Shared",component:()=>Z((()=>import("./shared-5QEVK11h.js")),__vite__mapDeps([4,1,2,5])),meta:{requiresAuth:!0}},{path:"/recent",name:"Recent",component:()=>Z((()=>import("./recent-C0T1Ytp7.js")),__vite__mapDeps([6,1,2,7])),meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:()=>Z((()=>import("./login-BmL8ZrbD.js")),__vite__mapDeps([8,1,2,9]))},{path:"/register",name:"Register",component:()=>Z((()=>import("./register-Bu1AAswD.js")),__vite__mapDeps([10,1,2,11]))},{path:"/share/:id",name:"ShareId",component:()=>Z((()=>import("./share-BfeguwWV.js")),__vite__mapDeps([12,1,2,13]))},{path:"/file/:id",name:"FileId",component:()=>Z((()=>import("./detail-84FUWXPA.js")),__vite__mapDeps([14,1,2,15]))},{path:"/admin",redirect:"/admin/config",children:[{path:"config",name:"AdminConfig",component:()=>Z((()=>import("./config-Buf1MB5e.js")),__vite__mapDeps([16,1,2,17]))}]}],X=w({history:T(),routes:Q});X.beforeEach(((e,t,n)=>{const o=localStorage.getItem("token");"/login"===e.path||"/register"===e.path||o?n():n("/login")}));const Y=R(K),ee=N();ee.use(D),Y.use(ee),Y.use(X),Y.use(V),Y.use(q),Y.mount("#app");export{$ as _,B as i,C as u};
