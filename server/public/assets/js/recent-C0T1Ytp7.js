import{_ as e,i as a}from"./index-WwQmHM_O.js";import{r as t,o,c as r,b as i,e as s,f as n,P as l,B as d,j as c,t as u,m,k as w,q as y,_ as p,$ as f,J as v,i as _}from"./vendor-CRD7CLCO.js";const b={class:"recent-container"},h={class:"file-name"},k=e({__name:"recent",setup(e){const k=t(!1),x=t([]),B=[{colKey:"name",title:"文件名",width:300},{colKey:"size",title:"大小",width:100},{colKey:"createdAt",title:"创建时间",width:180},{colKey:"op",title:"操作",width:120}];return o((()=>{(async()=>{k.value=!0;try{const{data:e}=await a.post("/api/files/recent");x.value=e}catch(e){v.error("加载最近文件失败")}finally{k.value=!1}})()})),(e,t)=>{const o=d,g=l,K=f;return _(),r("div",b,[t[1]||(t[1]=i("h2",null,"最近文件",-1)),s(K,{data:x.value,columns:B,loading:k.value,"row-key":"_id"},{name:n((({row:e})=>[i("div",h,[e.isFolder?(_(),m(w(y),{key:0})):(_(),m(w(p),{key:1})),c(" "+u(e.name),1)])])),size:n((({row:e})=>{return[c(u((a=e.size,a<1024?a+"B":a<1048576?(a/1024).toFixed(2)+"KB":a<1073741824?(a/1048576).toFixed(2)+"MB":(a/1073741824).toFixed(2)+"GB")),1)];var a})),createdAt:n((({row:e})=>{return[c(u((a=e.createdAt,new Date(a).toLocaleString())),1)];var a})),op:n((({row:e})=>[s(g,null,{default:n((()=>[s(o,{variant:"text",onClick:t=>(async e=>{try{const t=await a.get(`/api/files/download/${e._id}`,{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=o,r.setAttribute("download",e.originalName),document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(t){v.error("下载失败")}})(e)},{default:n((()=>t[0]||(t[0]=[c("下载")]))),_:2,__:[0]},1032,["onClick"])])),_:2},1024)])),_:1},8,["data","loading"])])}}},[["__scopeId","data-v-b24bcfdf"]]);export{k as default};
